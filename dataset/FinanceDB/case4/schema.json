{
  "metadata": {
    "version": "1.0.0",
    "generator": "Finance Database Designer",
    "generated_at": "2025-09-26T00:00:00Z",
    "tables_count": 4,
    "relations_count": 3
  },
  "tables": [
    {
      "id": "table_1",
      "name": "company",
      "type": "entity",
      "fields": [
        { "name": "CompanyName", "type": "VARCHAR(255)", "constraints": { "primary_key": true, "nullable": false }, "description": "Full legal name of the company" },
        { "name": "TelephoneNumber", "type": "VARCHAR(50)", "constraints": { "nullable": true }, "description": "Registered contact telephone number" },
        { "name": "Location", "type": "TEXT", "constraints": { "nullable": true }, "description": "Headquarters or primary office address" },
        { "name": "incorporationlocation", "type": "VARCHAR(255)", "constraints": { "nullable": true }, "description": "Jurisdiction where the company is incorporated" }
      ]
    },
    {
      "id": "table_2",
      "name": "report",
      "type": "entity",
      "fields": [
        { "name": "ReportName", "type": "VARCHAR(255)", "constraints": { "primary_key": true, "nullable": false }, "description": "Unique identifier for a specific financial report, formatted as 'year-company_first_word-report_type-quarter' (e.g., '2024-BioCorRx-10Q-Q1')" },
        { "name": "ReportType", "type": "ENUM('10-Q','10-K','8-K','20-F','Other')", "constraints": { "nullable": false }, "description": "Type of SEC filing (e.g., quarterly, annual, current report)" },
        { "name": "Year", "type": "INT", "constraints": { "nullable": false }, "description": "Fiscal year of the report" },
        { "name": "Period", "type": "ENUM('Q1','Q2','Q3','Q4','Annual')", "constraints": { "nullable": false }, "description": "Reporting period (quarterly or annual)" },
        { "name": "reportingPeriodEnd", "type": "DATE", "constraints": { "nullable": true }, "description": "Date when the report was published" },
        { "name": "audited", "type": "BOOLEAN", "constraints": { "nullable": true }, "description": "Whether the report is audited (true/false)" }
      ]
    },
    {
      "id": "table_3",
      "name": "company_report",
      "type": "entity",
      "fields": [ 
        { "name": "CompanyName", "type": "VARCHAR(255)", "constraints": { "foreign_key": true, "nullable": false }, "description": "Foreign key referencing company.CompanyName"},
        { "name": "ReportName", "type": "VARCHAR(255)", "constraints": { "foreign_key": true, "nullable": false }, "description": "Foreign key referencing report.ReportName" }
      ]
    },
    {
      "id": "table_4",
      "name": "cashFlowStatement",
      "type": "entity",
      "fields": [
        { "name": "ReportName", "type": "VARCHAR(255)", "constraints": { "foreign_key": true, "nullable": false }, "description": "Reference to the associated report" },
        { "name": "periodType", "type": "VARCHAR(20)", "description": "Period covered by the cash flow statement" },
        { "name": "netIncome", "type": "DECIMAL(20,4)", "description": "Net income value" },
        { "name": "operatingCashFlow", "type": "DECIMAL(20,4)", "description": "Cash flow from operating activities" },
        { "name": "investingCashFlow", "type": "DECIMAL(20,4)", "description": "Net cash flow from investing activities" },
        { "name": "financingCashFlow", "type": "DECIMAL(20,4)", "description": "Net cash flow from financing activities" }
      ]
    }
  ],
  "relations": [
    { "id": "ref_1", "type": "one-to-many", "from": { "table": "company", "field": "CompanyName" }, "to": { "table": "company_report", "field": "CompanyName" }},
    { "id": "ref_2", "type": "one-to-many", "from": { "table": "report", "field": "ReportName" }, "to": { "table": "company_report", "field": "ReportName" }},
    { "id": "ref_3", "type": "many-to-one", "from": { "table": "cashFlowStatement", "field": "ReportName" }, "to": { "table": "report", "field": "ReportName" } }
  ],
  "rules": [
    {
      "id": "phi_1",
      "name": "no_mutual_investment",
      "description": "No mutual investment: ¬(Hold(a,b) ∧ Hold(b,a)). Two companies cannot invest in each other simultaneously.",
      "type": "LOGIC",
      "severity": "ERROR",
      "scope": "multi_table",
      "tables": ["company_report"],
      "enabled": true,
      "validation_logic": {
        "constraint": "For any two companies A and B, if A holds shares in B, then B cannot hold shares in A",
        "check_method": "cross_reference",
        "fields": ["CompanyName", "ReportName"]
      },
      "fix_strategy": {
        "method": "llm_decision",
        "description": "Use LLM to determine which investment relationship is more credible based on report dates, investment amounts, and context"
      }
    },
    {
      "id": "phi_2",
      "name": "cash_sanity_bound",
      "description": "Cash sanity bound: ending_cash / beginning_cash < 10. The ratio of ending cash to beginning cash should be reasonable.",
      "type": "VALUE",
      "severity": "WARN",
      "scope": "single_table",
      "tables": ["cashFlowStatement"],
      "enabled": true,
      "validation_logic": {
        "constraint": "For each cash flow statement, the ratio of ending cash to beginning cash should be less than 10",
        "check_method": "formula",
        "formula": "ending_cash / beginning_cash < 10",
        "fields": ["ending_cash", "beginning_cash"]
      },
      "fix_strategy": {
        "method": "verify_source",
        "description": "Re-examine the source document to verify cash values, as large ratios may indicate extraction errors"
      }
    },
    {
      "id": "phi_3",
      "name": "recursive_investment",
      "description": "Recursive investment (transitive closure): Hold(a,b) ∧ Hold(b,c) ⇒ Hold(a,c). If company A invests in B, and B invests in C, then A indirectly invests in C.",
      "type": "LOGIC",
      "severity": "WARN",
      "scope": "multi_table",
      "tables": ["company_report"],
      "enabled": true,
      "validation_logic": {
        "constraint": "Investment relationships should satisfy transitive closure property",
        "check_method": "graph_analysis",
        "fields": ["CompanyName", "ReportName"]
      },
      "fix_strategy": {
        "method": "infer_missing",
        "description": "Infer and suggest adding missing indirect investment relationships based on transitive closure"
      }
    }
  ]
}
